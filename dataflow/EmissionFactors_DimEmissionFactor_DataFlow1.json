{
	"name": "EmissionFactors_DimEmissionFactor_DataFlow1",
	"properties": {
		"folder": {
			"name": "EmissionFactors"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "global-data-modeling-space-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "EmissionFactorscsvSource"
				}
			],
			"sinks": [
				{
					"name": "DimEmissionFactorSink"
				}
			],
			"transformations": [
				{
					"name": "SelectDimEmissionFactor"
				},
				{
					"name": "surrogateKey1"
				}
			],
			"script": "source(output(\n\t\tCountry as string,\n\t\tCarbonScope as string,\n\t\tEmissionCategory as string,\n\t\tEmissionType as string,\n\t\tEmissionFactorLocationBased as double '000,000,000.000',\n\t\tEmissionFactorMarketBased as double '000,000,000.000',\n\t\tUnitOfMeasure as string,\n\t\tStartDate as date 'dd-MM-yyyy',\n\t\tEndDate as date 'dd-MM-yyyy',\n\t\tRegion as string,\n\t\tHasMarketBasedFactor as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'delimited',\n\tfileSystem: 'fsgdmsdevweeu01',\n\tfolderPath: 'ESG_MAPDATA',\n\tfileName: 'EmissionFactors.csv',\n\tcolumnDelimiter: ';',\n\tescapeChar: '\\\\',\n\tquoteChar: '\\\"',\n\tcolumnNamesAsHeader: true) ~> EmissionFactorscsvSource\nsurrogateKey1 select(mapColumn(\n\t\tEmissionFactorName = EmissionType,\n\t\tEmissionFactorLocationBased,\n\t\tEmissionFactorMarketBased,\n\t\tEmissionPeriodStart = StartDate,\n\t\tEmissionPeriodEnd = EndDate,\n\t\tEmissionCountry = Country,\n\t\tEmissionFactorScope = CarbonScope,\n\t\tEmissionFactorEgridRegion = Region,\n\t\tEmissionFactorUom = UnitOfMeasure,\n\t\tEmissionFactorId\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectDimEmissionFactor\nEmissionFactorscsvSource keyGenerate(output(EmissionFactorId as long),\n\tstartAt: 1L,\n\tstepValue: 1L) ~> surrogateKey1\nSelectDimEmissionFactor sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'ADESGPOC',\n\ttableName: 'DimEmissionFactor',\n\tinput(\n\t\tEmissionFactorId as integer,\n\t\tEmissionFactorName as string,\n\t\tEmissionFactorLocationBased as double,\n\t\tEmissionFactorMarketBased as double,\n\t\tEmissionPeriodStart as date,\n\t\tEmissionPeriodEnd as date,\n\t\tEmissionCountry as string,\n\t\tEmissionFactorScope as string,\n\t\tEmissionFactorUom as string,\n\t\tEmissionFactorEgridRegion as string\n\t)) ~> DimEmissionFactorSink"
		}
	}
}